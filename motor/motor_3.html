<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Szerel√©si √ötmutat√≥</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <link rel="stylesheet" href="motorstyle.css">
        
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p id="loadingText">PDF feldolgoz√°sa...</p>
        </div>
    </div>

    <div class="container">
        <!-- Navig√°ci√≥s panel -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>üîß Szerel√©si √ötmutat√≥</h1>
                <div class="file-upload">
                    <input type="file" id="pdfUpload" accept=".pdf">
                    <label for="pdfUpload">üìÑ PDF Bet√∂lt√©se</label>
                </div>
                <div class="progress-container" id="progressContainer">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">0 / 0 oldal</div>
                </div>
            </div>
            <div class="toc" id="toc">
                <div class="toc-empty">
                    üìÅ T√∂lts fel egy PDF f√°jlt<br>a megjelen√≠t√©shez
                </div>
            </div>
        </div>

        <!-- Tartalom ter√ºlet -->
        <div class="main-content" id="mainContent">
            <div class="content-header">
                <h2>√údv√∂z√∂llek! üëã</h2>
                <p class="content-info">T√∂lts fel egy szerel√©si √∫tmutat√≥t PDF form√°tumban a kezd√©shez.</p>
            </div>
        </div>
    </div>

    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // P√©lda tartalomjegyz√©k - cser√©ld ki a saj√°todra!
        const tableOfContents = [
            {
                title: "1. Bevezet√©s",
                pages: [1, 2, 3]
            },
            {
                title: "2. Sz√ºks√©ges eszk√∂z√∂k",
                pages: [4, 5]
            },
            {
                title: "3. Alkatr√©szek list√°ja",
                pages: [6, 7, 8]
            },
            {
                title: "4. El≈ëk√©sz√ºletek",
                pages: [9, 10, 11, 12]
            },
            {
                title: "5. Szerel√©si l√©p√©sek",
                subsections: [
                    { title: "5.1 Alapszerkezet √∂sszeszerel√©se", pages: [13, 14, 15, 16] },
                    { title: "5.2 Villamos rendszer bek√∂t√©se", pages: [17, 18, 19, 20] },
                    { title: "5.3 Vezet√©kek csatlakoztat√°sa", pages: [21, 22, 23] },
                    { title: "5.4 Burkolat felszerel√©se", pages: [24, 25, 26] }
                ]
            },
            {
                title: "6. Ellen≈ërz√©s √©s tesztel√©s",
                pages: [27, 28, 29]
            },
            {
                title: "7. Karbantart√°s",
                pages: [30, 31, 32]
            },
            {
                title: "8. Hibaelh√°r√≠t√°s",
                pages: [33, 34, 35, 36]
            },
            {
                title: "9. Biztons√°gi el≈ë√≠r√°sok",
                pages: [37, 38]
            },
            {
                title: "10. Garanci√°lis inform√°ci√≥k",
                pages: [39, 40]
            }
        ];

        let pdfPages = [];

        async function processPDF(file) {
            const loadingOverlay = document.getElementById('loadingOverlay');
            const progressContainer = document.getElementById('progressContainer');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            loadingOverlay.style.display = 'flex';
            progressContainer.style.display = 'block';

            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
                const totalPages = pdf.numPages;
                
                pdfPages = [];

                for (let pageNum = 1; pageNum <= totalPages; pageNum++) {
                    const page = await pdf.getPage(pageNum);
                    const viewport = page.getViewport({ scale: 2.0 });
                    
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;

                    await page.render({
                        canvasContext: context,
                        viewport: viewport
                    }).promise;

                    const imageData = canvas.toDataURL('image/png');
                    pdfPages.push(imageData);

                    // Progress update
                    const progress = (pageNum / totalPages) * 100;
                    progressFill.style.width = progress + '%';
                    progressText.textContent = `${pageNum} / ${totalPages} oldal`;
                }

                renderContent();
                buildTOC();
                
                loadingOverlay.style.display = 'none';
                progressContainer.style.display = 'none';

            } catch (error) {
                console.error('Hiba a PDF feldolgoz√°sa sor√°n:', error);
                alert('Hiba t√∂rt√©nt a PDF bet√∂lt√©se sor√°n. K√©rlek, pr√≥b√°ld √∫jra!');
                loadingOverlay.style.display = 'none';
            }
        }

        function renderContent() {
            const mainContent = document.getElementById('mainContent');
            mainContent.innerHTML = '';

            tableOfContents.forEach((section, sectionIndex) => {
                if (section.subsections) {
                    section.subsections.forEach((subsection, subIndex) => {
                        renderSection(subsection, `${sectionIndex}-${subIndex}`, mainContent);
                    });
                } else {
                    renderSection(section, sectionIndex.toString(), mainContent);
                }
            });
        }

        function renderSection(section, id, container) {
            const sectionDiv = document.createElement('div');
            sectionDiv.className = 'page-section';
            sectionDiv.id = `section-${id}`;

            const title = document.createElement('h3');
            title.className = 'page-title';
            title.textContent = section.title;
            sectionDiv.appendChild(title);

            section.pages.forEach(pageNum => {
                if (pdfPages[pageNum - 1]) {
                    const img = document.createElement('img');
                    img.className = 'page-image';
                    img.src = pdfPages[pageNum - 1];
                    img.alt = `${section.title} - ${pageNum}. oldal`;
                    img.loading = 'lazy';
                    sectionDiv.appendChild(img);
                }
            });

            container.appendChild(sectionDiv);
        }

        function buildTOC() {
            const tocContainer = document.getElementById('toc');
            tocContainer.innerHTML = '';

            tableOfContents.forEach((section, sectionIndex) => {
                const sectionDiv = document.createElement('div');
                sectionDiv.className = 'toc-section';

                if (section.subsections) {
                    const mainDiv = document.createElement('div');
                    mainDiv.className = 'toc-main';
                    mainDiv.innerHTML = `
                        <span>${section.title}</span>
                        <span class="toc-arrow">‚ñ∂</span>
                    `;

                    const subsDiv = document.createElement('div');
                    subsDiv.className = 'toc-subs';

                    section.subsections.forEach((subsection, subIndex) => {
                        const subDiv = document.createElement('div');
                        subDiv.className = 'toc-sub';
                        subDiv.textContent = subsection.title;
                        subDiv.onclick = () => scrollToSection(`${sectionIndex}-${subIndex}`);
                        subsDiv.appendChild(subDiv);
                    });

                    mainDiv.onclick = (e) => {
                        e.stopPropagation();
                        const arrow = mainDiv.querySelector('.toc-arrow');
                        arrow.classList.toggle('expanded');
                        subsDiv.classList.toggle('expanded');
                    };

                    sectionDiv.appendChild(mainDiv);
                    sectionDiv.appendChild(subsDiv);
                } else {
                    const mainDiv = document.createElement('div');
                    mainDiv.className = 'toc-main';
                    mainDiv.textContent = section.title;
                    mainDiv.onclick = () => scrollToSection(sectionIndex.toString());
                    sectionDiv.appendChild(mainDiv);
                }

                tocContainer.appendChild(sectionDiv);
            });
        }

        function scrollToSection(id) {
            const element = document.getElementById(`section-${id}`);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        document.getElementById('pdfUpload').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file && file.type === 'application/pdf') {
                processPDF(file);
            }
        });
    </script>
</body>
</html>